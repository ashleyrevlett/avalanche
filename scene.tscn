[gd_scene load_steps=16 format=3 uid="uid://1i0se866c1tg"]

[ext_resource type="Script" path="res://scripts/game.gd" id="1_8h2uv"]
[ext_resource type="Texture2D" uid="uid://dhd7xyrddhrll" path="res://assets/l0_bg_1.png" id="1_8vm77"]
[ext_resource type="Script" path="res://scripts/character.gd" id="1_elf0q"]
[ext_resource type="Texture2D" uid="uid://b0k4oy3v10kqa" path="res://assets/l1_bg_1.png" id="1_qo76c"]
[ext_resource type="Script" path="res://scripts/camera.gd" id="3_s3w6k"]
[ext_resource type="PackedScene" uid="uid://ckdduyp6itwn5" path="res://spawner.tscn" id="5_akxtr"]
[ext_resource type="PackedScene" uid="uid://b8wcb1enfr6ee" path="res://ground.tscn" id="8_spv53"]
[ext_resource type="Script" path="res://scripts/terrain.gd" id="8_tujsh"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_g0o5x"]
size = Vector2(50, 50)

[sub_resource type="PlaceholderTexture2D" id="PlaceholderTexture2D_770fh"]
size = Vector2(50, 50)

[sub_resource type="Animation" id="Animation_u01bd"]
resource_name = "dying"
length = 0.3
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:self_modulate")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.3),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Color(1, 1, 1, 1), Color(1, 0, 0, 1)]
}

[sub_resource type="Animation" id="Animation_sq7yu"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:self_modulate")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Color(1, 1, 1, 1)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_3beka"]
_data = {
"RESET": SubResource("Animation_sq7yu"),
"dying": SubResource("Animation_u01bd")
}

[sub_resource type="RectangleShape2D" id="RectangleShape2D_1esqg"]
size = Vector2(57.3876, 54)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_vua0g"]
size = Vector2(42.2856, 5)

[node name="Game" type="Node2D"]
position = Vector2(0, -2)
script = ExtResource("1_8h2uv")

[node name="ParallaxBackground" type="ParallaxBackground" parent="."]
layer = -1
visible = false
follow_viewport_enabled = true

[node name="ParallaxLayer" type="ParallaxLayer" parent="ParallaxBackground"]
motion_scale = Vector2(0.1, 0.1)
motion_mirroring = Vector2(3820, 30)

[node name="Sprite2D" type="Sprite2D" parent="ParallaxBackground/ParallaxLayer"]
scale = Vector2(6, 6)
texture = ExtResource("1_8vm77")
offset = Vector2(2.08165e-12, 2.08165e-12)

[node name="Sprite2D3" type="Sprite2D" parent="ParallaxBackground/ParallaxLayer"]
position = Vector2(0, -4266)
scale = Vector2(6, 6)
texture = ExtResource("1_8vm77")
offset = Vector2(2.08165e-12, 2.08165e-12)

[node name="Sprite2D2" type="Sprite2D" parent="ParallaxBackground/ParallaxLayer"]
position = Vector2(0, -2190)
scale = Vector2(6, 6)
texture = ExtResource("1_8vm77")
offset = Vector2(2.08165e-12, 2.08165e-12)
flip_v = true

[node name="ParallaxLayer2" type="ParallaxLayer" parent="ParallaxBackground"]
motion_scale = Vector2(0.15, 0.15)
motion_mirroring = Vector2(1440, 2.08165e-12)

[node name="Sprite2D" type="Sprite2D" parent="ParallaxBackground/ParallaxLayer2"]
position = Vector2(95, 694)
scale = Vector2(2.05938, 2.05938)
texture = ExtResource("1_qo76c")

[node name="Camera2D" type="Camera2D" parent="." groups=["camera"]]
unique_name_in_owner = true
position = Vector2(-241, 125)
scale = Vector2(0.993246, 1)
zoom = Vector2(0.7, 0.7)
limit_left = -2000
limit_bottom = 2000
limit_smoothed = true
drag_horizontal_enabled = true
drag_vertical_enabled = true
editor_draw_limits = true
editor_draw_drag_margin = true
script = ExtResource("3_s3w6k")

[node name="Character" type="CharacterBody2D" parent="."]
unique_name_in_owner = true
position = Vector2(-241, 125)
scale = Vector2(0.993246, 1)
collision_layer = 2
floor_stop_on_slope = false
floor_block_on_wall = false
floor_max_angle = 1.5708
script = ExtResource("1_elf0q")
speed = 700
jump_speed = -1500
acceleration = 0.35

[node name="CollisionShape2D" type="CollisionShape2D" parent="Character"]
unique_name_in_owner = true
position = Vector2(2.08165e-12, 2.08165e-12)
shape = SubResource("RectangleShape2D_g0o5x")

[node name="Sprite2D" type="Sprite2D" parent="Character"]
scale = Vector2(-2.92466, 4)
texture = SubResource("PlaceholderTexture2D_770fh")
hframes = 3
vframes = 4

[node name="AnimationPlayer" type="AnimationPlayer" parent="Character/Sprite2D"]
unique_name_in_owner = true
libraries = {
"": SubResource("AnimationLibrary_3beka")
}

[node name="GroundDetector" type="Area2D" parent="Character"]

[node name="CollisionShape2D" type="CollisionShape2D" parent="Character/GroundDetector"]
position = Vector2(0, 2)
shape = SubResource("RectangleShape2D_1esqg")
debug_color = Color(0.513726, 0.772549, 0.478431, 0.419608)

[node name="VisibleOnScreenNotifier2D" type="VisibleOnScreenNotifier2D" parent="Character"]
unique_name_in_owner = true

[node name="HeadDetector" type="Area2D" parent="Character"]
unique_name_in_owner = true
position = Vector2(0, -25)

[node name="CollisionShape2D" type="CollisionShape2D" parent="Character/HeadDetector"]
position = Vector2(0, -1)
shape = SubResource("RectangleShape2D_vua0g")

[node name="Terrain" type="Node2D" parent="."]
position = Vector2(2.08165e-12, 2.08165e-12)
script = ExtResource("8_tujsh")
ground_scene = ExtResource("8_spv53")
spawner_scene = ExtResource("5_akxtr")

[node name="GameOverUI" type="CanvasLayer" parent="."]
unique_name_in_owner = true

[node name="VBoxContainer" type="VBoxContainer" parent="GameOverUI"]
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -163.5
offset_top = -60.5
offset_right = 163.5
offset_bottom = 60.5
grow_horizontal = 2
grow_vertical = 2
theme_override_constants/separation = 20

[node name="GameOverLabel" type="Label" parent="GameOverUI/VBoxContainer"]
unique_name_in_owner = true
layout_mode = 2
theme_override_font_sizes/font_size = 48
text = "Game Over"
horizontal_alignment = 1

[node name="RestartButton" type="Button" parent="GameOverUI/VBoxContainer"]
unique_name_in_owner = true
layout_mode = 2
theme_override_font_sizes/font_size = 32
text = "Restart"

[node name="ScoreUI" type="CanvasLayer" parent="."]

[node name="MarginContainer" type="MarginContainer" parent="ScoreUI"]
offset_right = 40.0
offset_bottom = 40.0
theme_override_constants/margin_left = 20
theme_override_constants/margin_top = 20

[node name="ScoreLabel" type="Label" parent="ScoreUI/MarginContainer"]
unique_name_in_owner = true
layout_mode = 2
theme_override_font_sizes/font_size = 32
text = "Altitude: 0"

[node name="PlayerPos" type="Label" parent="ScoreUI"]
offset_right = 40.0
offset_bottom = 23.0

[connection signal="body_entered" from="Character/GroundDetector" to="Character" method="_on_ground_detector_body_entered"]
[connection signal="body_exited" from="Character/GroundDetector" to="Character" method="_on_ground_detector_body_exited"]
[connection signal="screen_entered" from="Character/VisibleOnScreenNotifier2D" to="Character" method="_on_screen_entered"]
[connection signal="screen_exited" from="Character/VisibleOnScreenNotifier2D" to="Character" method="_on_screen_exited"]
[connection signal="body_entered" from="Character/HeadDetector" to="Character" method="_on_head_detector_body_entered"]
[connection signal="body_exited" from="Character/HeadDetector" to="Character" method="_on_head_detector_body_exited"]
